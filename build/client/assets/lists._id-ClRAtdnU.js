import{u as R,a as M,b as U,r as B,j as e,L as g,F as p}from"./components-B71KIw6b.js";import{S as y,H as v}from"./header-BHzBVBdg.js";import{B as c}from"./button-CpX_ak2_.js";import{I as x}from"./input-gR889RM_.js";import{C as l,a as i,b as w,c as _,d as L}from"./card-D6xvUs-C.js";import{A as D}from"./arrow-left-CfikeANU.js";import{U as o}from"./users-TLTQjisN.js";import{P as I}from"./plus-DNHlCd_Y.js";import{U as E}from"./user-plus-Dcuvb96f.js";import{S as T}from"./search-D3iH17Gw.js";import{c as $}from"./createLucideIcon-DDdTbUiS.js";import"./send-Du1D2yV1.js";import"./bar-chart-3-CLxhACnx.js";import"./logo-CCAmY4eY.js";const z=$("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);function se(){const{user:u,list:s,members:A,availableRecipients:C,error:n}=R(),r=M(),m=U().state==="submitting",[h,S]=B.useState(""),k=A||[],d=C||[];if(n&&!s)return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(y,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(v,{user:u||{id:"",email:"",full_name:"Guest"}}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(l,{className:"border-red-200 bg-red-50",children:e.jsxs(i,{className:"p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-900 mb-4",children:"Database Configuration Required"}),e.jsx("p",{className:"text-red-800 mb-6",children:n}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-red-700",children:"To access this functionality, you need to set up your Supabase database."}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx(g,{to:"/demo",children:e.jsx(c,{variant:"outline",children:"View Demo Version"})}),e.jsx(c,{onClick:()=>window.open("/setup-demo.md","_blank"),children:"Setup Guide"})]})]})]})})})})]})]});const N=k.filter(a=>{var b;if(!a||!a.subscribers)return!1;const t=a.subscribers,j=`${t.first_name||""} ${t.last_name||""}`.trim(),f=h.toLowerCase();return((b=t.email)==null?void 0:b.toLowerCase().includes(f))||j.toLowerCase().includes(f)});return e.jsxs("div",{className:"flex h-screen bg-gray-50",children:[e.jsx(y,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(v,{user:u}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center mb-8",children:[e.jsx(g,{to:"/lists",className:"mr-4",children:e.jsxs(c,{variant:"outline",size:"sm",children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Back to Lists"]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-6 h-6 rounded-full mr-3",style:{backgroundColor:(s==null?void 0:s.color)||"#3B82F6"}}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900",children:(s==null?void 0:s.name)||"List"}),(s==null?void 0:s.description)&&e.jsx("p",{className:"text-gray-600 mt-2",children:s.description})]})]})}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsx("span",{className:`px-3 py-1 text-sm rounded-full ${s!=null&&s.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s!=null&&s.is_active?"Active":"Inactive"})})]}),n&&e.jsx(l,{className:"mb-6 border-red-200 bg-red-50",children:e.jsx(i,{className:"p-4",children:e.jsx("p",{className:"text-red-800",children:n})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(l,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-50",children:e.jsx(o,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Members"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(s==null?void 0:s.total_members)||0})]})]})})}),e.jsx(l,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-green-50",children:e.jsx(o,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Subscribed"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(s==null?void 0:s.subscribed_members)||0})]})]})})}),e.jsx(l,{children:e.jsx(i,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-50",children:e.jsx(o,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Available to Add"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:d.length})]})]})})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(l,{children:[e.jsxs(w,{children:[e.jsxs(_,{className:"flex items-center",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Add Recipients"]}),e.jsx(L,{children:"Add new recipients to this list"})]}),e.jsxs(i,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Add New Recipient"}),e.jsxs(p,{method:"post",className:"space-y-3",children:[e.jsx("input",{type:"hidden",name:"_action",value:"add-by-email"}),e.jsx(x,{name:"email",type:"email",placeholder:"Email address",required:!0}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(x,{name:"firstName",placeholder:"First name"}),e.jsx(x,{name:"lastName",placeholder:"Last name"})]}),e.jsx(c,{type:"submit",size:"sm",className:"w-full",disabled:m,children:m?"Adding...":"Add Recipient"})]})]}),d.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Add Existing Recipients"}),e.jsxs("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:[d.slice(0,10).map(a=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:a.email}),(a.first_name||a.last_name)&&e.jsx("p",{className:"text-xs text-gray-500",children:[a.first_name,a.last_name].filter(Boolean).join(" ")})]}),e.jsxs(p,{method:"post",className:"inline",children:[e.jsx("input",{type:"hidden",name:"_action",value:"add-recipient"}),e.jsx("input",{type:"hidden",name:"subscriberId",value:a.id}),e.jsx(c,{type:"submit",size:"sm",variant:"outline",disabled:m,children:e.jsx(E,{className:"h-3 w-3"})})]})]},a.id)),d.length>10&&e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["And ",d.length-10," more recipients..."]})]})]}),(r==null?void 0:r.error)&&e.jsx("div",{className:"text-red-600 text-sm bg-red-50 p-3 rounded-md",children:r.error}),(r==null?void 0:r.success)&&e.jsx("div",{className:"text-green-600 text-sm bg-green-50 p-3 rounded-md",children:r.success})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(l,{children:[e.jsxs(w,{children:[e.jsx(_,{children:"List Members"}),e.jsx(L,{children:"Manage recipients in this list"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"relative",children:[e.jsx(T,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(x,{placeholder:"Search members...",value:h,onChange:a=>S(a.target.value),className:"pl-10"})]})}),N.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-gray-600",children:h?"No members match your search.":"No members in this list yet."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Email"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Name"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Status"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Added"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-900",children:"Actions"})]})}),e.jsx("tbody",{children:N.map(a=>{const t=a.subscribers;return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:t.email}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:[t.first_name,t.last_name].filter(Boolean).join(" ")||"-"}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${t.status==="subscribed"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.status==="subscribed"?"Subscribed":"Unsubscribed"})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-500",children:new Date(a.added_at).toLocaleDateString()}),e.jsx("td",{className:"py-3 px-4 text-sm",children:e.jsxs(p,{method:"post",className:"inline",children:[e.jsx("input",{type:"hidden",name:"_action",value:"remove-recipient"}),e.jsx("input",{type:"hidden",name:"membershipId",value:a.id}),e.jsx(c,{type:"submit",variant:"outline",size:"sm",className:"text-red-600 hover:text-red-700",disabled:m,onClick:j=>{confirm("Remove this recipient from the list?")||j.preventDefault()},children:e.jsx(z,{className:"h-4 w-4"})})]})})]},a.id)})})]})})]})]})})]})]})})]})]})}export{se as default};
